<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-3.1.0 plugin-docs plugin-id-default docs-doc-id-pythonapi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="UCLCHEM RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="UCLCHEM Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-186542401-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css">
<script src="https://buttons.github.io/buttons.js"></script><title data-rh="true">Python Reference | UCLCHEM</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://uclchem.github.io/img/undraw_online.svg"><meta data-rh="true" name="twitter:image" content="https://uclchem.github.io/img/undraw_online.svg"><meta data-rh="true" property="og:url" content="https://uclchem.github.io/docs/pythonapi"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="3.1.0"><meta data-rh="true" name="docusaurus_tag" content="docs-default-3.1.0"><meta data-rh="true" name="docsearch:version" content="3.1.0"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-3.1.0"><meta data-rh="true" property="og:title" content="Python Reference | UCLCHEM"><meta data-rh="true" name="description" content="* uclchem"><meta data-rh="true" property="og:description" content="* uclchem"><link data-rh="true" rel="icon" href="/img/uclchem-logo.jpg"><link data-rh="true" rel="canonical" href="https://uclchem.github.io/docs/pythonapi"><link data-rh="true" rel="alternate" href="https://uclchem.github.io/docs/pythonapi" hreflang="en"><link data-rh="true" rel="alternate" href="https://uclchem.github.io/docs/pythonapi" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.dbe2f3b0.css">
<link rel="preload" href="/assets/js/runtime~main.ead62b3c.js" as="script">
<link rel="preload" href="/assets/js/main.4239c6d7.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/uclchem-logo.jpg" alt="UCLCHEM" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/uclchem-logo.jpg" alt="UCLCHEM" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">UCLCHEM</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">UCLCHEM</a><a class="navbar__item navbar__link" href="/3dpdr">3D-PDR</a><a class="navbar__item navbar__link" href="/emulators">Emulators</a><a class="navbar__item navbar__link" href="/ucl_pdr">UCLPDR</a><a class="navbar__item navbar__link" href="/othersoftware">Other</a></div><div class="navbar__items navbar__items--right"><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/getting-started">Getting Started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting Started&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/">Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/network">Creating a Network</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/parameters">Model Parameters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/pythonapi">Python Reference</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/tutorials">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/trouble-compile">Troubleshooting</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/physics-core">Physics</a><button aria-label="Toggle the collapsible sidebar category &#x27;Physics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/chemistry">Chemistry</a><button aria-label="Toggle the collapsible sidebar category &#x27;Chemistry&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/developer">Developer</a><button aria-label="Toggle the collapsible sidebar category &#x27;Developer&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/">🏠</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/getting-started"><span itemprop="name">Getting Started</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">Python Reference</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 3.1.0</span><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Python API</h1><ul><li><p><a href="#uclchem">uclchem</a></p></li><li><p><a href="#uclchem.model">uclchem.model</a></p><ul><li><a href="#uclchem.model.cloud">cloud</a></li><li><a href="#uclchem.model.collapse">collapse</a></li><li><a href="#uclchem.model.hot_core">hot<!-- -->_<!-- -->core</a></li><li><a href="#uclchem.model.cshock">cshock</a></li><li><a href="#uclchem.model.jshock">jshock</a></li></ul></li><li><p><a href="#uclchem.utils">uclchem.utils</a></p><ul><li><a href="#uclchem.utils.cshock_dissipation_time">cshock<!-- -->_<!-- -->dissipation<!-- -->_<!-- -->time</a></li><li><a href="#uclchem.utils.check_error">check<!-- -->_<!-- -->error</a></li><li><a href="#uclchem.utils.get_species_table">get<!-- -->_<!-- -->species<!-- -->_<!-- -->table</a></li><li><a href="#uclchem.utils.get_reaction_table">get<!-- -->_<!-- -->reaction<!-- -->_<!-- -->table</a></li></ul></li><li><p><a href="#uclchem.analysis">uclchem.analysis</a></p><ul><li><a href="#uclchem.analysis.read_output_file">read<!-- -->_<!-- -->output<!-- -->_<!-- -->file</a></li><li><a href="#uclchem.analysis.create_abundance_plot">create<!-- -->_<!-- -->abundance<!-- -->_<!-- -->plot</a></li><li><a href="#uclchem.analysis.plot_species">plot<!-- -->_<!-- -->species</a></li><li><a href="#uclchem.analysis.analysis">analysis</a></li><li><a href="#uclchem.analysis.total_element_abundance">total<!-- -->_<!-- -->element<!-- -->_<!-- -->abundance</a></li><li><a href="#uclchem.analysis.check_element_conservation">check<!-- -->_<!-- -->element<!-- -->_<!-- -->conservation</a></li></ul></li><li><p><a href="#uclchem.tests">uclchem.tests</a></p><ul><li><a href="#uclchem.tests.test_ode_conservation">test<!-- -->_<!-- -->ode<!-- -->_<!-- -->conservation</a></li></ul></li></ul><a id="uclchem"></a><h1>uclchem</h1><p>The UCLCHEM python module is divided into three parts.
<code>model</code> contains the functions for running chemical models under different physics.
<code>analysis</code> contains functions for reading and plotting output files as well as investigating the chemistry.
<code>tests</code> contains functions for testing the code.</p><a id="uclchem.model"></a><h1>uclchem.model</h1><a id="uclchem.model.cloud"></a><h4 class="anchor anchorWithStickyNavbar_mojV" id="cloud">cloud<a class="hash-link" href="#cloud" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">cloud</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">param_dict</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> out_species</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Run cloud model from UCLCHEM</p><p><strong>Arguments</strong>:</p><ul><li><code>param_dict</code> <em>dict,optional</em> - A dictionary of parameters where keys are any of the variables in defaultparameters.f90 and values are value for current run.</li><li><code>out_species</code> <em>list, optional</em> - A list of species for which final abundance will be returned. If None, no abundances will be returned.. Defaults to None.</li></ul><p><strong>Returns</strong>:</p><p>  A list where the first element is always an integer which is negative if the model failed to run and can be sent to <code>uclchem.utils.check_error()</code> to see more details. If the <code>out_species</code> parametere is provided, the remaining elements of this list will be the final abundances of the species in out_species.</p><a id="uclchem.model.collapse"></a><h4 class="anchor anchorWithStickyNavbar_mojV" id="collapse">collapse<a class="hash-link" href="#collapse" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">collapse</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">collapse</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> physics_output</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> param_dict</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> out_species</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Run collapse model from UCLCHEM based on Priestley et al 2018 AJ 156 51 (<a href="https://ui.adsabs.harvard.edu/abs/2018AJ....156...51P/abstract" target="_blank" rel="noopener noreferrer">https://ui.adsabs.harvard.edu/abs/2018AJ....156...51P/abstract</a>)</p><p><strong>Arguments</strong>:</p><ul><li><code>collapse</code> <em>str</em> - A string containing the collapse type, options are &#x27;BE1.1&#x27;, &#x27;BE4&#x27;, &#x27;filament&#x27;, or &#x27;ambipolar&#x27;</li><li><code>physics_output(str)</code> - Filename to store physics output, only relevant for &#x27;filament&#x27; and &#x27;ambipolar&#x27; collapses. If None, no physics output will be saved.</li><li><code>param_dict</code> <em>dict,optional</em> - A dictionary of parameters where keys are any of the variables in defaultparameters.f90 and values are value for current run.</li><li><code>out_species</code> <em>list, optional</em> - A list of species for which final abundance will be returned. If None, no abundances will be returned.. Defaults to None.</li></ul><p><strong>Returns</strong>:</p><p>  A list where the first element is always an integer which is negative if the model failed to run and can be sent to <code>uclchem.utils.check_error()</code> to see more details. If the <code>out_species</code> parametere is provided, the remaining elements of this list will be the final abundances of the species in out_species.</p><a id="uclchem.model.hot_core"></a><h4 class="anchor anchorWithStickyNavbar_mojV" id="hot_core">hot<!-- -->_<!-- -->core<a class="hash-link" href="#hot_core" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">hot_core</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">temp_indx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> max_temperature</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> param_dict</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> out_species</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Run hot core model from UCLCHEM, based on Viti et al. 2004 and Collings et al. 2004</p><p><strong>Arguments</strong>:</p><ul><li><code>temp_indx</code> <em>int</em> - Used to select the mass of hot core. 1=1Msun,2=5, 3=10, 4=15, 5=25,6=60]</li><li><code>max_temperature</code> <em>float</em> - Value at which gas temperature will stop increasing.</li><li><code>param_dict</code> <em>dict,optional</em> - A dictionary of parameters where keys are any of the variables in defaultparameters.f90 and values are value for current run.</li><li><code>out_species</code> <em>list, optional</em> - A list of species for which final abundance will be returned. If None, no abundances will be returned.. Defaults to None.</li></ul><p><strong>Returns</strong>:</p><p>  A list where the first element is always an integer which is negative if the model failed to run and can be sent to <code>uclchem.utils.check_error()</code> to see more details. If the <code>out_species</code> parametere is provided, the remaining elements of this list will be the final abundances of the species in out_species.</p><a id="uclchem.model.cshock"></a><h4 class="anchor anchorWithStickyNavbar_mojV" id="cshock">cshock<a class="hash-link" href="#cshock" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">cshock</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">shock_vel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> timestep_factor</span><span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> minimum_temperature</span><span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> param_dict</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> out_species</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Run C-type shock model from UCLCHEM</p><p><strong>Arguments</strong>:</p><ul><li><code>shock_vel</code> <em>float</em> - Velocity of the shock in km/s</li><li><code>timestep_factor</code> <em>float, optional</em> - Whilst the time is less than 2 times the dissipation time of shock, timestep is timestep_factor*dissipation time. Essentially controls
how well resolved the shock is in your model. Defaults to 0.01.</li><li><code>minimum_temperature</code> <em>float, optional</em> - Minimum post-shock temperature. Defaults to 0.0 (no minimum). The shocked gas typically cools to <code>initialTemp</code> if this is not set.</li><li><code>param_dict</code> <em>dict,optional</em> - A dictionary of parameters where keys are any of the variables in defaultparameters.f90 and values are value for current run.</li><li><code>out_species</code> <em>list, optional</em> - A list of species for which final abundance will be returned. If None, no abundances will be returned.. Defaults to None.</li></ul><p><strong>Returns</strong>:</p><p>  A list where the first element is always an integer which is negative if the model failed to run and can be sent to <code>uclchem.utils.check_error()</code> to see more details. If the model succeeded, the second element is the dissipation time and further elements are the abundances of all species in <code>out_species</code>.</p><a id="uclchem.model.jshock"></a><h4 class="anchor anchorWithStickyNavbar_mojV" id="jshock">jshock<a class="hash-link" href="#jshock" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">jshock</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">shock_vel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> param_dict</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> out_species</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Run J-type shock model from UCLCHEM</p><p><strong>Arguments</strong>:</p><ul><li><code>shock_vel</code> <em>float</em> - Velocity of the shock</li><li><code>param_dict</code> <em>dict,optional</em> - A dictionary of parameters where keys are any of the variables in defaultparameters.f90 and values are value for current run.</li><li><code>out_species</code> <em>list, optional</em> - A list of species for which final abundance will be returned. If None, no abundances will be returned.. Defaults to None.</li></ul><p><strong>Returns</strong>:</p><p>  A list where the first element is always an integer which is negative if the model failed to run and can be sent to <code>uclchem.utils.check_error()</code> to see more details. If the model succeeded, the second element is the dissipation time and further elements are the abundances of all species in <code>out_species</code>.</p><a id="uclchem.utils"></a><h1>uclchem.utils</h1><a id="uclchem.utils.cshock_dissipation_time"></a><h4 class="anchor anchorWithStickyNavbar_mojV" id="cshock_dissipation_time">cshock<!-- -->_<!-- -->dissipation<!-- -->_<!-- -->time<a class="hash-link" href="#cshock_dissipation_time" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">cshock_dissipation_time</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">shock_vel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> initial_dens</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>A simple function used to calculate the dissipation time of a C-type shock.
Use to obtain a useful timescale for your C-shock model runs. Velocity of
ions and neutrals equalizes at dissipation time and full cooling takes a few dissipation times.</p><p><strong>Arguments</strong>:</p><ul><li><code>shock_vel</code> <em>float</em> - Velocity of the shock in km/s</li><li><code>initial_dens</code> <em>float</em> - Preshock density of the gas in cm<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mrow><mo>−</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">^{-3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></span></span></li></ul><p><strong>Returns</strong>:</p><ul><li><code>float</code> - The dissipation time of the shock in years</li></ul><a id="uclchem.utils.check_error"></a><h4 class="anchor anchorWithStickyNavbar_mojV" id="check_error">check<!-- -->_<!-- -->error<a class="hash-link" href="#check_error" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">check_error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">error_code</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Converts the UCLCHEM integer result flag to a simple messaging explaining what went wrong&quot;</p><p><strong>Arguments</strong>:</p><ul><li><code>error_code</code> <em>int</em> - Error code returned by UCLCHEM models, the first element of the results list.</li></ul><p><strong>Returns</strong>:</p><ul><li><code>str</code> - Error message</li></ul><a id="uclchem.utils.get_species_table"></a><h4 class="anchor anchorWithStickyNavbar_mojV" id="get_species_table">get<!-- -->_<!-- -->species<!-- -->_<!-- -->table<a class="hash-link" href="#get_species_table" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">get_species_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>A simple function to load the list of species in the UCLCHEM network into a pandas dataframe.</p><p><strong>Returns</strong>:</p><ul><li><code>pandas.DataFrame</code> - A dataframe containing the species names and their details</li></ul><a id="uclchem.utils.get_reaction_table"></a><h4 class="anchor anchorWithStickyNavbar_mojV" id="get_reaction_table">get<!-- -->_<!-- -->reaction<!-- -->_<!-- -->table<a class="hash-link" href="#get_reaction_table" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">get_reaction_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>A function to load the reaction table from the UCLCHEM network into a pandas dataframe.</p><p><strong>Returns</strong>:</p><ul><li><code>pandas.DataFrame</code> - A dataframe containing the reactions and their rates</li></ul><a id="uclchem.analysis"></a><h1>uclchem.analysis</h1><a id="uclchem.analysis.read_output_file"></a><h4 class="anchor anchorWithStickyNavbar_mojV" id="read_output_file">read<!-- -->_<!-- -->output<!-- -->_<!-- -->file<a class="hash-link" href="#read_output_file" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">read_output_file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">output_file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Read the output of a UCLCHEM run created with the outputFile parameter into a pandas DataFrame</p><p><strong>Arguments</strong>:</p><ul><li><code>output_file</code> <em>str</em> - path to file containing a full UCLCHEM output</li></ul><p><strong>Returns</strong>:</p><ul><li><code>pandas.DataFrame</code> - A dataframe containing the abundances and physical parameters of the model at every time step.</li></ul><a id="uclchem.analysis.create_abundance_plot"></a><h4 class="anchor anchorWithStickyNavbar_mojV" id="create_abundance_plot">create<!-- -->_<!-- -->abundance<!-- -->_<!-- -->plot<a class="hash-link" href="#create_abundance_plot" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">create_abundance_plot</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> species</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> figsize</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">16</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">9</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> plot_file</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Create a plot of the abundance of a list of species through time.</p><p><strong>Arguments</strong>:</p><ul><li><code>df</code> <em>pd.DataFrame</em> - Pandas dataframe containing the UCLCHEM output, see <code>read_output_file</code></li><li><code>species</code> <em>list</em> - list of strings containing species names. Using a $ instead of # or @ will plot the sum of surface and bulk abundances.</li><li><code>figsize</code> <em>tuple, optional</em> - Size of figure, width by height in inches. Defaults to (16, 9).</li><li><code>plot_file</code> <em>str, optional</em> - Path to file where figure will be saved. If None, figure is not saved. Defaults to None.</li></ul><p><strong>Returns</strong>:</p><ul><li><code>fig,ax</code> - matplotlib figure and axis objects</li></ul><a id="uclchem.analysis.plot_species"></a><h4 class="anchor anchorWithStickyNavbar_mojV" id="plot_species">plot<!-- -->_<!-- -->species<a class="hash-link" href="#plot_species" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">plot_species</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ax</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> species</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Plot the abundance of a list of species through time directly onto an axis.</p><p><strong>Arguments</strong>:</p><ul><li><code>ax</code> <em>pyplot.axis</em> - An axis object to plot on</li><li><code>df</code> <em>pd.DataFrame</em> - A dataframe created by <code>read_output_file</code></li><li><code>species</code> <em>str</em> - A list of species names to be plotted. If species name starts with &quot;$&quot; instead of # or @, plots the sum of surface and bulk abundances</li></ul><p><strong>Returns</strong>:</p><ul><li><code>pyplot.axis</code> - Modified input axis is returned</li></ul><a id="uclchem.analysis.analysis"></a><h4 class="anchor anchorWithStickyNavbar_mojV" id="analysis">analysis<a class="hash-link" href="#analysis" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">analysis</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">species_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> result_file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> output_file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> rate_threshold</span><span class="token operator">=</span><span class="token number">0.99</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>A function which loops over every time step in an output file and finds the rate of change of a species at that time due to each of the reactions it is involved in.
From this, the most important reactions are identified and printed to file. This can be used to understand the chemical reason behind a species&#x27; behaviour.</p><p><strong>Arguments</strong>:</p><ul><li><code>species_name</code> <em>str</em> - Name of species to be analysed</li><li><code>result_file</code> <em>str</em> - The path to the file containing the UCLCHEM output</li><li><code>output_file</code> <em>str</em> - The path to the file where the analysis output will be written</li><li><code>rate_threshold</code> <em>float,optional</em> - Analysis output will contain the only the most efficient reactions that are responsible for rate_threshold of the total production and destruction rate. Defaults to 0.99.</li></ul><a id="uclchem.analysis.total_element_abundance"></a><h4 class="anchor anchorWithStickyNavbar_mojV" id="total_element_abundance">total<!-- -->_<!-- -->element<!-- -->_<!-- -->abundance<a class="hash-link" href="#total_element_abundance" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">total_element_abundance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">element</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Calculates that the total elemental abundance of a species as a function of time. Allows you to check conservation.</p><p><strong>Arguments</strong>:</p><ul><li><code>element</code> <em>str</em> - Name of element</li><li><code>df</code> <em>pandas.DataFrame</em> - DataFrame from <code>read_output_file()</code></li></ul><p><strong>Returns</strong>:</p><ul><li><code>pandas.Series</code> - Total abundance of element for all time steps in df.</li></ul><a id="uclchem.analysis.check_element_conservation"></a><h4 class="anchor anchorWithStickyNavbar_mojV" id="check_element_conservation">check<!-- -->_<!-- -->element<!-- -->_<!-- -->conservation<a class="hash-link" href="#check_element_conservation" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">check_element_conservation</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> element_list</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;H&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;N&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;C&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;O&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Check the conservation of major element by comparing total abundance at start and end of model</p><p><strong>Arguments</strong>:</p><ul><li><code>df</code> <em>pandas.DataFrame</em> - UCLCHEM output in format from <code>read_output_file</code></li><li><code>element_list</code> <em>list, optional</em> - List of elements to check. Defaults to <!-- -->[&quot;H&quot;, &quot;N&quot;, &quot;C&quot;, &quot;O&quot;]<!-- -->.</li></ul><p><strong>Returns</strong>:</p><ul><li><code>dict</code> - Dictionary containing the change in the total abundance of each element as a fraction of initial value</li></ul><a id="uclchem.tests"></a><h1>uclchem.tests</h1><a id="uclchem.tests.test_ode_conservation"></a><h4 class="anchor anchorWithStickyNavbar_mojV" id="test_ode_conservation">test<!-- -->_<!-- -->ode<!-- -->_<!-- -->conservation<a class="hash-link" href="#test_ode_conservation" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">test_ode_conservation</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">element_list</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;H&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;N&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;C&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;O&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Test whether the ODEs conserve elements. Useful to run each time you change network.
Integrator errors may still cause elements not to be conserved but they cannot be conserved
if the ODEs are not correct.</p><p><strong>Arguments</strong>:</p><ul><li><code>element_list</code> <em>list, optional</em> - A list of elements for which to check the conservation. Defaults to <!-- -->[&quot;H&quot;, &quot;N&quot;, &quot;C&quot;, &quot;O&quot;]<!-- -->.</li></ul><p><strong>Returns</strong>:</p><ul><li><code>dict</code> - A dictionary of the elements in element list with values representing the total rate of change of each element.</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_foO9"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-02-15T12:37:28.000Z">2/15/2023</time></b> by <b>Gijs Vermariën</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/parameters"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Model Parameters</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/category/tutorials"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tutorials</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/uclchem-logo.jpg" class="themedImage_W2Cr themedImage--light_TfLj footer__logo"><img src="/img/uclchem-logo.jpg" class="themedImage_W2Cr themedImage--dark_oUvU footer__logo"></div><div class="footer__copyright">Copyright © 2021 Jon Holdship</div></div></div></footer></div>
<script src="/assets/js/runtime~main.ead62b3c.js"></script>
<script src="/assets/js/main.4239c6d7.js"></script>
</body>
</html>