<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-v3.5.0 docs-doc-page docs-doc-id-running_a_grid" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Running a Grid | UCLCHEM</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://uclchem.github.io/img/undraw_online.svg"><meta data-rh="true" name="twitter:image" content="https://uclchem.github.io/img/undraw_online.svg"><meta data-rh="true" property="og:url" content="https://uclchem.github.io/docs/running_a_grid"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="v3.5.0"><meta data-rh="true" name="docusaurus_tag" content="docs-default-v3.5.0"><meta data-rh="true" name="docsearch:version" content="v3.5.0"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-v3.5.0"><meta data-rh="true" property="og:title" content="Running a Grid | UCLCHEM"><meta data-rh="true" name="description" content="A common task is to run UCLCHEM over a grid of parameter combinations. This notebook sets up a simple approach to doing so for regular grids."><meta data-rh="true" property="og:description" content="A common task is to run UCLCHEM over a grid of parameter combinations. This notebook sets up a simple approach to doing so for regular grids."><link data-rh="true" rel="icon" href="/img/uclchem-logo.jpg"><link data-rh="true" rel="canonical" href="https://uclchem.github.io/docs/running_a_grid"><link data-rh="true" rel="alternate" href="https://uclchem.github.io/docs/running_a_grid" hreflang="en"><link data-rh="true" rel="alternate" href="https://uclchem.github.io/docs/running_a_grid" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Tutorials","item":"https://uclchem.github.io/docs/category/tutorials"},{"@type":"ListItem","position":2,"name":"Running a Grid","item":"https://uclchem.github.io/docs/running_a_grid"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="UCLCHEM RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="UCLCHEM Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-186542401-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css">
<script src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/assets/css/styles.9999ee4d.css">
<script src="/assets/js/runtime~main.99d7365e.js" defer="defer"></script>
<script src="/assets/js/main.f6f34fde.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/uclchem-logo.jpg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/uclchem-logo.jpg" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/uclchem-logo.jpg" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">UCLCHEM</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">UCLCHEM</a><a class="navbar__item navbar__link" href="/3dpdr">3D-PDR</a><a class="navbar__item navbar__link" href="/emulators">Emulators</a><a class="navbar__item navbar__link" href="/ucl_pdr">UCLPDR</a><a class="navbar__item navbar__link" href="/uclchemcmc">UCLCHEMCMC</a><a class="navbar__item navbar__link" href="/othersoftware">Other</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/running_a_grid">v3.5.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/running_a_grid">Develop ðŸš§</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/running_a_grid">v3.5.0</a></li><li><a class="dropdown__link" href="/docs/v3.4.0/running_a_grid">v3.4.0</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/getting-started">Getting Started</a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/tutorials">Tutorials</a><button aria-label="Collapse sidebar category &#x27;Tutorials&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/first_model">Running Your First Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2a_modelling_objects_on_disk">Advanced Physical Modelling on Disk</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2b_modelling_objects_in_memory">Advanced Physical Modelling in Memory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/running_a_grid">Running a Grid</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/chemical_analysis">Chemical Analysis</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/trouble-compile">Troubleshooting</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/physics-core">Physics</a><button aria-label="Expand sidebar category &#x27;Physics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/chemistry">Chemistry</a><button aria-label="Expand sidebar category &#x27;Chemistry&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/developer">Developer</a><button aria-label="Expand sidebar category &#x27;Developer&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/tutorials"><span>Tutorials</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Running a Grid</span></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v3.5.0</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Running a Grid</h1></header>
<p>A common task is to run UCLCHEM over a grid of parameter combinations. This notebook sets up a simple approach to doing so for regular grids.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> uclchem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> pandas </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> joblib </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> Parallel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> delayed</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-simple-grid">A Simple Grid<a href="#a-simple-grid" class="hash-link" aria-label="Direct link to A Simple Grid" title="Direct link to A Simple Grid">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="define-parameter-space">Define Parameter Space<a href="#define-parameter-space" class="hash-link" aria-label="Direct link to Define Parameter Space" title="Direct link to Define Parameter Space">â€‹</a></h3>
<p>First, we define our parameter space. We do this by using numpy and pandas to produce a table of all possible combinations of some parameters of interest.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># This part can be substituted with any choice of grid</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># here we just vary the density, temperature and zeta</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">temperatures </span><span class="token operator">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">linspace</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">10</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">50</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">densities </span><span class="token operator">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">logspace</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">6</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">zetas </span><span class="token operator">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">logspace</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># meshgrid will give all combinations, then we shape into columns and put into a table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">parameterSpace </span><span class="token operator">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">asarray</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">meshgrid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">temperatures</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> densities</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> zetas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">reshape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">model_table </span><span class="token operator">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">parameterSpace</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">T</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> columns</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;temperature&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;density&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;zeta&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># keep track of where each model output will be saved and make sure that folder exists</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">model_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;outputFile&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> model_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">apply</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">lambda</span><span class="token plain"> row</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;../grid_folder/\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string-interpolation interpolation">temperature\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">_\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string-interpolation interpolation">density\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">_\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string-interpolation interpolation">zeta\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">.csv&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> axis</span><span class="token operator">=</span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">model_table</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string-interpolation interpolation">shape</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string-interpolation interpolation number">0</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token string-interpolation interpolation">\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)"> models to run&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">not</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">exists</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;../grid_folder&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">makedirs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;../grid_folder&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<p>27 models to run</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">model_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">head</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<div><table border="1" class="dataframe"><thead><tr><th></th><th>temperature</th><th>density</th><th>zeta</th><th>outputFile</th></tr></thead><tbody><tr><th>0</th><td>10.0</td><td>10000.0</td><td>10.0</td><td>../grid_folder/10.0_10000.0_10.0.csv</td></tr><tr><th>1</th><td>10.0</td><td>10000.0</td><td>100.0</td><td>../grid_folder/10.0_10000.0_100.0.csv</td></tr><tr><th>2</th><td>10.0</td><td>10000.0</td><td>1000.0</td><td>../grid_folder/10.0_10000.0_1000.0.csv</td></tr><tr><th>3</th><td>30.0</td><td>10000.0</td><td>10.0</td><td>../grid_folder/30.0_10000.0_10.0.csv</td></tr><tr><th>4</th><td>30.0</td><td>10000.0</td><td>100.0</td><td>../grid_folder/30.0_10000.0_100.0.csv</td></tr></tbody></table></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="set-up-the-model">Set up the model<a href="#set-up-the-model" class="hash-link" aria-label="Direct link to Set up the model" title="Direct link to Set up the model">â€‹</a></h3>
<p>Next, we need a function that will run our model. We write a quick function that takes a row from our dataframe and uses it to populate a parameter dictionary for UCLCHEM and then run a cloud model. We can then map our dataframe to that function.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">run_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">row</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># basic set of parameters we&#x27;ll use for this grid.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ParameterDictionary </span><span class="token operator">=</span><span class="token plain"> \</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;endatfinaldensity&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean">False</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;freefall&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean">False</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;initialDens&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> row</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">density</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;initialTemp&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> row</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">temperature</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;zeta&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> row</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">zeta</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;outputFile&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> row</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">outputFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;finalTime&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1.0e6</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;baseAv&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">10</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;abstol_min&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1e-22</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    \</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    result </span><span class="token operator">=</span><span class="token plain"> uclchem</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">cloud</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">param_dict</span><span class="token operator">=</span><span class="token plain">ParameterDictionary</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> result</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># just the integer error code</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="run-grid">Run Grid<a href="#run-grid" class="hash-link" aria-label="Direct link to Run Grid" title="Direct link to Run Grid">â€‹</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-simple-way">The Simple Way<a href="#the-simple-way" class="hash-link" aria-label="Direct link to The Simple Way" title="Direct link to The Simple Way">â€‹</a></h4>
<p>We can use pandas apply to simply pass each row to our helper function in turn. This will take some time since we&#x27;re running the models one by one. I&#x27;ll use the <code>head</code> function just to run five rows as an example here.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">%</span><span class="token operator">%</span><span class="token plain">time</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">result </span><span class="token operator">=</span><span class="token plain"> model_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">head</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">apply</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">run_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> axis</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<p>CPU times: user 42.8 s, sys: 653 ms, total: 43.5 s
Wall time: 43.7 s</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-fast-way">The Fast Way<a href="#the-fast-way" class="hash-link" aria-label="Direct link to The Fast Way" title="Direct link to The Fast Way">â€‹</a></h4>
<p>Alternatively, we can use multiprocessing to run the models in parallel. That will allow us to run many models simulataneously and make use of all the cores available on our machine.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">%</span><span class="token operator">%</span><span class="token plain">time</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">results </span><span class="token operator">=</span><span class="token plain"> Parallel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">n_jobs</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> verbose</span><span class="token operator">=</span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    delayed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">run_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">row</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> idx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> row </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> model_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">iterrows</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<p>[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.</p>
<p>[Parallel(n_jobs=4)]: Done   1 tasks      | elapsed:    7.4s
[Parallel(n_jobs=4)]: Done   2 tasks      | elapsed:    8.1s
[Parallel(n_jobs=4)]: Done   3 tasks      | elapsed:    9.3s
[Parallel(n_jobs=4)]: Done   4 tasks      | elapsed:   13.8s
[Parallel(n_jobs=4)]: Done   5 tasks      | elapsed:   14.9s
[Parallel(n_jobs=4)]: Done   6 tasks      | elapsed:   17.5s
[Parallel(n_jobs=4)]: Done   7 tasks      | elapsed:   23.0s
[Parallel(n_jobs=4)]: Done   8 tasks      | elapsed:   25.6s
[Parallel(n_jobs=4)]: Done   9 tasks      | elapsed:   29.9s
[Parallel(n_jobs=4)]: Done  10 tasks      | elapsed:   42.2s
[Parallel(n_jobs=4)]: Done  11 tasks      | elapsed:   49.9s
[Parallel(n_jobs=4)]: Done  12 tasks      | elapsed:   55.0s
[Parallel(n_jobs=4)]: Done  13 tasks      | elapsed:   58.1s
[Parallel(n_jobs=4)]: Done  14 tasks      | elapsed:  1.2min
[Parallel(n_jobs=4)]: Done  15 tasks      | elapsed:  1.2min
[Parallel(n_jobs=4)]: Done  16 tasks      | elapsed:  1.2min
[Parallel(n_jobs=4)]: Done  17 tasks      | elapsed:  1.5min
[Parallel(n_jobs=4)]: Done  18 tasks      | elapsed:  1.5min
[Parallel(n_jobs=4)]: Done  19 tasks      | elapsed:  1.7min
[Parallel(n_jobs=4)]: Done  20 tasks      | elapsed:  1.9min
[Parallel(n_jobs=4)]: Done  21 out of  27 | elapsed:  2.0min remaining:   34.1s
[Parallel(n_jobs=4)]: Done  22 out of  27 | elapsed:  2.0min remaining:   27.1s
[Parallel(n_jobs=4)]: Done  23 out of  27 | elapsed:  2.2min remaining:   23.2s
[Parallel(n_jobs=4)]: Done  24 out of  27 | elapsed:  2.2min remaining:   16.7s
[Parallel(n_jobs=4)]: Done  25 out of  27 | elapsed:  2.5min remaining:   11.8s
[Parallel(n_jobs=4)]: Done  27 out of  27 | elapsed:  6.2min finished
CPU times: user 218 ms, sys: 150 ms, total: 368 ms
Wall time: 6min 13s</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="checking-your-grid">Checking Your Grid<a href="#checking-your-grid" class="hash-link" aria-label="Direct link to Checking Your Grid" title="Direct link to Checking Your Grid">â€‹</a></h2>
<p>After running, we should do two things. First, let&#x27;s add <code>results</code> to our dataframe as a new column. Positive results mean a successful UCLCHEM run and negative ones are unsuccessful. Then we can run each model through <code>check_element_conservation</code> to check the integration was successful. We&#x27;ll use both these things to flag models that failed in some way.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">element_check</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">output_file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    df </span><span class="token operator">=</span><span class="token plain"> uclchem</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">analysis</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">read_output_file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">output_file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># get conservation values</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    conserves </span><span class="token operator">=</span><span class="token plain"> uclchem</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">analysis</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">check_element_conservation</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># check if any error is greater than 1%</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">all</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token builtin" style="color:rgb(189, 147, 249)">float</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> x </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> conserves</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">values</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">model_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;run_result&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> results</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">model_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;elements_conserved&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> model_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;outputFile&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">element_check</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># check both conditions are met</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">model_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Successful&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">model_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">run_result </span><span class="token operator">&gt;=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">elements_conserved</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">model_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">head</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<div><table border="1" class="dataframe"><thead><tr><th></th><th>temperature</th><th>density</th><th>zeta</th><th>outputFile</th><th>run_result</th><th>elements_conserved</th><th>Successful</th></tr></thead><tbody><tr><th>0</th><td>10.0</td><td>10000.0</td><td>10.0</td><td>../grid_folder/10.0_10000.0_10.0.csv</td><td>0</td><td>True</td><td>True</td></tr><tr><th>1</th><td>10.0</td><td>10000.0</td><td>100.0</td><td>../grid_folder/10.0_10000.0_100.0.csv</td><td>0</td><td>True</td><td>True</td></tr><tr><th>2</th><td>10.0</td><td>10000.0</td><td>1000.0</td><td>../grid_folder/10.0_10000.0_1000.0.csv</td><td>0</td><td>True</td><td>True</td></tr><tr><th>3</th><td>30.0</td><td>10000.0</td><td>10.0</td><td>../grid_folder/30.0_10000.0_10.0.csv</td><td>0</td><td>True</td><td>True</td></tr><tr><th>4</th><td>30.0</td><td>10000.0</td><td>100.0</td><td>../grid_folder/30.0_10000.0_100.0.csv</td><td>0</td><td>True</td><td>True</td></tr></tbody></table></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="complex-grid">Complex Grid<a href="#complex-grid" class="hash-link" aria-label="Direct link to Complex Grid" title="Direct link to Complex Grid">â€‹</a></h2>
<p>The above was straightforward enough but what about a modelling a grid of shocks? Not only do we want to loop over relevant parameters, we also need to run a few preliminary models to give ourselves starting abundances. We&#x27;ll start by defining two helper functions, one to run our preliminary cloud and one to run the shock.</p>
<p>Let&#x27;s further imagine that we want to obtain the abundances of several species at the end of the model. We can use the <code>out_species</code> parameter to specify which species we want to track and return them to our dataframe.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">out_species </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;CO&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;H2O&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;CH3OH&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">run_prelim</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">density</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># basic set of parameters we&#x27;ll use for this grid.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ParameterDictionary </span><span class="token operator">=</span><span class="token plain"> \</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;endatfinaldensity&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;freefall&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;initialDens&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1e2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;finalDens&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">float</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">density</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;initialTemp&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">10.0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;abundSaveFile&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;../grid_folder/starts/\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">density</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token string-interpolation interpolation format-spec">.0f\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">.csv&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;baseAv&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    \</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    result </span><span class="token operator">=</span><span class="token plain"> uclchem</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">cloud</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">param_dict</span><span class="token operator">=</span><span class="token plain">ParameterDictionary</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> result</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">run_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">row</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># basic set of parameters we&#x27;ll use for this grid.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ParameterDictionary </span><span class="token operator">=</span><span class="token plain"> \</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;endatfinaldensity&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean">False</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;freefall&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean">False</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;initialDens&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">float</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">row</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">density</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;initialTemp&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">10.0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;outputFile&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> row</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">outputFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;abundLoadFile&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;../grid_folder/starts/\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string-interpolation interpolation">density</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token string-interpolation interpolation format-spec">.0f\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">.csv&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;finalTime&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1.0e5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;abstol_factor&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1e-14</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;abstol_min&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1e-20</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;reltol&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1e-6</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;baseAv&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    \</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    result </span><span class="token operator">=</span><span class="token plain"> uclchem</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">cshock</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        row</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">shock_velocity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> param_dict</span><span class="token operator">=</span><span class="token plain">ParameterDictionary</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> out_species</span><span class="token operator">=</span><span class="token plain">out_species</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># First check UCLCHEM&#x27;s result flag to seeif it ran succesfully, if it is return the abundances</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> result</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> result</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># if not, return NaNs because model failed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">nan</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">len</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">out_species</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<p>Then we define our parameter space again. We&#x27;ll create two folders, one to store a set of initial abundances for each starting density in our model and another to store our shock outputs.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># This part can be substituted with any choice of grid</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># here we just combine various initial and final densities into an easily iterable array</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">shock_velocities </span><span class="token operator">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">linspace</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">10</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">50</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">densities </span><span class="token operator">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">logspace</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">6</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">parameterSpace </span><span class="token operator">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">asarray</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">meshgrid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">shock_velocities</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> densities</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">reshape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">model_table </span><span class="token operator">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">parameterSpace</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">T</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> columns</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;shock_velocity&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;density&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">model_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;outputFile&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> model_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">apply</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">lambda</span><span class="token plain"> row</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;../grid_folder/shocks/\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string-interpolation interpolation">shock_velocity\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">_\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string-interpolation interpolation">density\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">.csv&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> axis</span><span class="token operator">=</span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">model_table</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string-interpolation interpolation">shape</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string-interpolation interpolation number">0</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token string-interpolation interpolation">\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)"> models to run&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> folder </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;starts&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;shocks&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">not</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">exists</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;../grid_folder/\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">folder\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">makedirs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;../grid_folder/\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">folder\</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<p>9 models to run</p>
<p>We can then run our preliminary models followed by our science models. The science models will return the abundances at the final time step of each run so we can unpack those directly to our dataframe.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">results </span><span class="token operator">=</span><span class="token plain"> Parallel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">n_jobs</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> verbose</span><span class="token operator">=</span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    delayed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">run_prelim</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dens</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> dens </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> densities</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<p>[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">results </span><span class="token operator">=</span><span class="token plain"> Parallel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">n_jobs</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> verbose</span><span class="token operator">=</span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    delayed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">run_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">row</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> idx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> row </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> model_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">iterrows</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<p>[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.5335516294406D+09
ISTATE -1: Reducing time step to    37025057.016786143      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.5337421822880D+09
ISTATE -1: Reducing time step to    36716425.432567358      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.5338870980660D+09
ISTATE -1: Reducing time step to    36481556.721932642      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.5578538245666D+09
ISTATE -1: Reducing time step to    61184164.576365016      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.5275624753235D+12
ISTATE -1: Reducing time step to    25031525286063.090      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.3624332510045D+12
ISTATE -1: Reducing time step to    9335740036630.7051      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.5848597632469D+12
ISTATE -1: Reducing time step to    22120518952113.727      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.5579887306693D+09
ISTATE -1: Reducing time step to    60960745.314617805      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.8122437636366D+12   R2 =   0.3351314472062D+04
ISTATE -5 - shortening step at time   25703.916570777641      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.9667454198516D+12   R2 =   0.1149101028733D-05
ISTATE -5 - shortening step at time   30593.209488974091      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1166434749650D+13   R2 =   0.2220049248659D+03
ISTATE -5 - shortening step at time   36912.492077539842      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1167611392815D+13   R2 =   0.6656890691008D+03
ISTATE -5 - shortening step at time   36949.727620723010      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1178287693214D+13   R2 =   0.4072462170449D-04
ISTATE -5 - shortening step at time   37287.585228285512      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1167831922315D+13   R2 =   0.2855535747341D+04
ISTATE -5 - shortening step at time   36956.706402376993      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1167923574272D+13   R2 =   0.1416265357005D+03
ISTATE -5 - shortening step at time   36959.606780764043      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1168154780560D+13   R2 =   0.1943892680823D+04
ISTATE -5 - shortening step at time   36966.923435451135      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1414345141165D+13   R2 =   0.9733822968482D+04
ISTATE -5 - shortening step at time   44757.757631792883      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1168943279340D+13   R2 =   0.2597716335951D-04
ISTATE -5 - shortening step at time   36991.875928468980      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1169071520458D+13   R2 =   0.1597357776302D+04
ISTATE -5 - shortening step at time   36995.934191705179      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1169220297724D+13   R2 =   0.9990739747528D+03
ISTATE -5 - shortening step at time   37000.642333048476      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1169511894755D+13   R2 =   0.5058567054156D+03
ISTATE -5 - shortening step at time   37009.870087169606      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1550849118130D+13   R2 =   0.6483857579871D-04
ISTATE -5 - shortening step at time   49077.503738286956      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1169715639283D+13   R2 =   0.1744845365680D+04
ISTATE -5 - shortening step at time   37016.317698834122      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1552244186825D+13   R2 =   0.9187899890813D-04
ISTATE -5 - shortening step at time   49121.651481801375      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1289447841315D+13   R2 =   0.1378455055303D-04
ISTATE -5 - shortening step at time   40805.311434004245      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1290251640064D+13   R2 =   0.4423940862798D+03
ISTATE -5 - shortening step at time   40830.748103295118      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1290759462532D+13   R2 =   0.1449041774656D+03
ISTATE -5 - shortening step at time   40846.818434552792      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.3212605409996D+11   R2 =   0.9487090607619D-07
ISTATE -5 - shortening step at time   1016.6472816442981      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1290891532280D+13   R2 =   0.3340968975726D-04
ISTATE -5 - shortening step at time   40850.997856946778      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1291064805460D+13   R2 =   0.5545927521902D+03
ISTATE -5 - shortening step at time   40856.481185443190      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1875370676837D+13   R2 =   0.1945327079762D-05
ISTATE -5 - shortening step at time   59347.173317633074      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.3678651326443D+11   R2 =   0.3858220650600D-04
ISTATE -5 - shortening step at time   1164.1301665959361      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2062549968121D+13   R2 =   0.1116644664220D-05
ISTATE -5 - shortening step at time   65270.568611412535      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2062750120629D+13   R2 =   0.1254519469361D+04
ISTATE -5 - shortening step at time   65276.902551546147      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2062850593192D+13   R2 =   0.5674979910345D+03
ISTATE -5 - shortening step at time   65280.082063029768      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2062905791493D+13   R2 =   0.1021370979395D+03
ISTATE -5 - shortening step at time   65281.828844715666      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2063153794621D+13   R2 =   0.1011730551787D+04
ISTATE -5 - shortening step at time   65289.677044971031      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1885533205539D+13   R2 =   0.7075798532258D-06
ISTATE -5 - shortening step at time   59668.772327184051      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.4569942640962D+11   R2 =   0.1539070755750D-06
ISTATE -5 - shortening step at time   1446.1843800513079      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2063215484970D+13   R2 =   0.2054504462855D-04
ISTATE -5 - shortening step at time   65291.629271199330      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.4631858445910D+11   R2 =   0.1757589004069D-02
ISTATE -5 - shortening step at time   1465.7779892119986      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2063552943002D+13   R2 =   0.1453679572896D+04
ISTATE -5 - shortening step at time   65302.308322862038      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2063671333860D+13   R2 =   0.2030026229383D+03
ISTATE -5 - shortening step at time   65306.054868986314      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2076023169579D+13   R2 =   0.3436007284567D-06
ISTATE -5 - shortening step at time   65696.935746183226      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2076164303312D+13   R2 =   0.1194592568328D+04
ISTATE -5 - shortening step at time   65701.402003534196      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2146456894165D+13   R2 =   0.1106321681621D+06
ISTATE -5 - shortening step at time   67925.851081182278      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.4984282901989D+11   R2 =   0.1476175558270D-05
ISTATE -5 - shortening step at time   1577.3047158194111      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.5484925337511D+11   R2 =   0.7038366722792D-05
ISTATE -5 - shortening step at time   1735.7358663011037      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.5493931277967D+11   R2 =   0.5346816162889D+03
ISTATE -5 - shortening step at time   1738.5858474580498      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2267894316430D+13   R2 =   0.1379628225853D-05
ISTATE -5 - shortening step at time   71768.807481974130      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.5500171001321D+11   R2 =   0.9013063648500D+02
ISTATE -5 - shortening step at time   1740.5604434558586      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.5581136531366D+09
ISTATE -1: Reducing time step to    60753757.328615919      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2494333111372D+13   R2 =   0.1124296052978D-05
ISTATE -5 - shortening step at time   78934.592132016551      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.7953322710271D+11   R2 =   0.6068119935427D-06
ISTATE -5 - shortening step at time   2516.8742754022073      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.8732488424293D+11   R2 =   0.1373283059164D-05
ISTATE -5 - shortening step at time   2763.4457038902410      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2743868469188D+13   R2 =   0.6031783486930D-05
ISTATE -5 - shortening step at time   86831.280670501175      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.9623908573851D+11   R2 =   0.1579775762817D-04
ISTATE -5 - shortening step at time   3045.5406879273983      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1056492605072D+12   R2 =   0.4824509132425D-06
ISTATE -5 - shortening step at time   3343.3310287090144      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1062051292277D+12   R2 =   0.1061151278702D-03
ISTATE -5 - shortening step at time   3360.9218110017737      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1160997537601D+12   R2 =   0.1176676234018D-05
ISTATE -5 - shortening step at time   3674.0428405089783      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1163937793092D+12   R2 =   0.1833456713515D+03
ISTATE -5 - shortening step at time   3683.3474464946744      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1275924895272D+12   R2 =   0.1143798613529D-04
ISTATE -5 - shortening step at time   4037.7370103557255      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.4395591895412D+12   R2 =   0.1171440439679D-06
ISTATE -5 - shortening step at time   13910.100934849299      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.4834979843115D+12   R2 =   0.4248274037828D-07
ISTATE -5 - shortening step at time   15300.569123782352      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.5582138671279D+09
ISTATE -1: Reducing time step to    60587638.199620269      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.5849799961933D+12   R2 =   0.6283662633056D-07
ISTATE -5 - shortening step at time   18512.025195989845      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.6434671451818D+12   R2 =   0.1798403888089D-07
ISTATE -5 - shortening step at time   20362.884341196845      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.8564223272750D+12   R2 =   0.2115611372332D-06
ISTATE -5 - shortening step at time   27101.972382121214      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1379244773499D+13   R2 =   0.1053269119022D-06
ISTATE -5 - shortening step at time   43646.986503124099      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1668867720969D+13   R2 =   0.1542742271797D-07
ISTATE -5 - shortening step at time   52812.269650920323      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1835751705551D+13   R2 =   0.1289877589706D-06
ISTATE -5 - shortening step at time   58093.408403515285      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.5583078597776D+09
ISTATE -1: Reducing time step to    60431774.074822776      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2221253451040D+13   R2 =   0.7056911402998D-07
ISTATE -5 - shortening step at time   70292.830729120251      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.6019073918102D+11   R2 =   0.1762502404619D-05
ISTATE -5 - shortening step at time   1904.7702272474369      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.8037050802231D+10
ISTATE -1: Reducing time step to    20093452451.680614      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.6062913053246D+11   R2 =   0.1638273598721D-03
ISTATE -5 - shortening step at time   1918.6433712805313      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.6572508640559D+11   R2 =   0.8772962197884D-06
ISTATE -5 - shortening step at time   2079.9077976453855      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.6596324429774D+11   R2 =   0.6825860967081D-05
ISTATE -5 - shortening step at time   2087.4444398017649      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.6623751112820D+11   R2 =   0.1450966460740D+03
ISTATE -5 - shortening step at time   2096.1237698797786      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.6636324705989D+11   R2 =   0.9880599722037D+03
ISTATE -5 - shortening step at time   2100.1027550598651      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.7956755530785D+11   R2 =   0.3696933045875D-06
ISTATE -5 - shortening step at time   2517.9606110077543      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.8747216495131D+11   R2 =   0.6991752296575D-05
ISTATE -5 - shortening step at time   2768.1064858009240      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.8754924320061D+11   R2 =   0.1395493605349D-04
ISTATE -5 - shortening step at time   2770.5456709053310      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.8766474880043D+11   R2 =   0.8608890040219D+03
ISTATE -5 - shortening step at time   2774.2009114061029      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.8775350048082D+11   R2 =   0.2745464651002D-05
ISTATE -5 - shortening step at time   2777.0095088867515      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.5584008754231D+09
ISTATE -1: Reducing time step to    60277475.029261358      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1866640043705D+12   R2 =   0.8572398372024D+01
ISTATE -5 - shortening step at time   5907.0887459014893      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2052584001552D+12   R2 =   0.5292236157888D-06
ISTATE -5 - shortening step at time   6495.5189922523377      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2258278333125D+12   R2 =   0.4733989427460D+02
ISTATE -5 - shortening step at time   7146.4504212810516      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2730215231419D+12   R2 =   0.4715867581554D-06
ISTATE -5 - shortening step at time   8639.9216184161178      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.8037066801555D+10
ISTATE -1: Reducing time step to    20093085528.711781      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.3002536020179D+12   R2 =   0.2108206170470D-05
ISTATE -5 - shortening step at time   9501.6962663902268      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.4395401483307D+12   R2 =   0.2211613989437D-06
ISTATE -5 - shortening step at time   13909.498364897116      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.5318161916820D+12   R2 =   0.9365899574633D+01
ISTATE -5 - shortening step at time   16829.626319052102      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.5318490304554D+12   R2 =   0.7379786398131D-06
ISTATE -5 - shortening step at time   16830.665520739753      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.6434778852150D+12   R2 =   0.2158453911462D-06
ISTATE -5 - shortening step at time   20363.224215663402      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.5584764499842D+09
ISTATE -1: Reducing time step to    60152067.814386435      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.8564207716730D+12   R2 =   0.6118815217590D+01
ISTATE -5 - shortening step at time   27101.923154208242      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1379229195480D+13   R2 =   0.2791933563082D-05
ISTATE -5 - shortening step at time   43646.493527842562      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1379236605006D+13   R2 =   0.8246852089811D+01
ISTATE -5 - shortening step at time   43646.728006513782      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.8037079031834D+10
ISTATE -1: Reducing time step to    20092805042.648476      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1517157053307D+13   R2 =   0.2640179150402D-06
ISTATE -5 - shortening step at time   48011.299155284483      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1668861570879D+13   R2 =   0.1187711933423D+01
ISTATE -5 - shortening step at time   52812.075027809558      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1668869383652D+13   R2 =   0.4551286979319D-06
ISTATE -5 - shortening step at time   52812.322267461932      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1835742461936D+13   R2 =   0.2521377324372D+01
ISTATE -5 - shortening step at time   58093.115884040373      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.5585572755919D+09
ISTATE -1: Reducing time step to    60017907.093298167      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2019317644598D+13   R2 =   0.3152782532574D-06
ISTATE -5 - shortening step at time   63902.457107540919      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2221250509813D+13   R2 =   0.7373395586521D-07
ISTATE -5 - shortening step at time   70292.737652322816      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.8037091518668D+10
ISTATE -1: Reducing time step to    20092518671.835888      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2443366131128D+13   R2 =   0.2136686351367D-05
ISTATE -5 - shortening step at time   77321.713010374922      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2956466031688D+13   R2 =   0.2032520688308D-06
ISTATE -5 - shortening step at time   93559.051635690965      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.5586355736731D+09
ISTATE -1: Reducing time step to    59887902.332642876      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.8037101739256D+10
ISTATE -1: Reducing time step to    20092284273.968025      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.8037112980263D+10
ISTATE -1: Reducing time step to    20092026473.161282      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.8037123207463D+10
ISTATE -1: Reducing time step to    20091791922.251476      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.8037133219462D+10
ISTATE -1: Reducing time step to    20091562306.143318      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.8037143155437D+10
ISTATE -1: Reducing time step to    20091334432.932369      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.8037151917220D+10
ISTATE -1: Reducing time step to    20091133488.320671      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.5195087796204D+11
ISTATE -1: Reducing time step to    348380717389.52661      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.6040955475817D+11   R2 =   0.1096779129307D-07
ISTATE -5 - shortening step at time   1911.6947708282948      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.6041587124232D+11   R2 =   0.1362499960324D+02
ISTATE -5 - shortening step at time   1911.8946595671098      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.6042140087360D+11   R2 =   0.2138495319862D-04
ISTATE -5 - shortening step at time   1912.0696478987077      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.6042913765509D+11   R2 =   0.1545026632908D-05
ISTATE -5 - shortening step at time   1912.3144827561578      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.6043536756342D+11   R2 =   0.1193062721983D+02
ISTATE -5 - shortening step at time   1912.5116317538477      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.6044248578155D+11   R2 =   0.4475434455206D-06
ISTATE -5 - shortening step at time   1912.7368918211218      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.6044868855065D+11   R2 =   0.4039665118968D+01
ISTATE -5 - shortening step at time   1912.9331819825004      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.6045482109501D+11   R2 =   0.2470307575126D+02
ISTATE -5 - shortening step at time   1913.1272498421019      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.6046206656054D+11   R2 =   0.4951416476650D+01
ISTATE -5 - shortening step at time   1913.3565367260758      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.6046908034337D+11   R2 =   0.4834354483672D-05
ISTATE -5 - shortening step at time   1913.5784918786464      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.6735356228474D+11   R2 =   0.8858300932160D-07
ISTATE -5 - shortening step at time   2131.4418444537359      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.6768986549635D+11   R2 =   0.4972428848123D+03
ISTATE -5 - shortening step at time   2142.0843511504690      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.9796556989366D+11   R2 =   0.1121741282765D-06
ISTATE -5 - shortening step at time   3100.1762624577013      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.9807246937832D+11   R2 =   0.2629368625177D-05
ISTATE -5 - shortening step at time   3103.5591575416397      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.9822832218142D+11   R2 =   0.5999469556134D-05
ISTATE -5 - shortening step at time   3108.4912082727615      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1428810335213D+12   R2 =   0.1763857944883D-05
ISTATE -5 - shortening step at time   4521.5516937117736      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1429812724701D+12   R2 =   0.1279821046433D-04
ISTATE -5 - shortening step at time   4524.7238123463439      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1432422025451D+12   R2 =   0.8682128241857D-05
ISTATE -5 - shortening step at time   4532.9810931994289      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1570712776519D+12   R2 =   0.1684043996923D+02
ISTATE -5 - shortening step at time   4970.6100522759943      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2089146231981D+12   R2 =   0.5216511058888D-06
ISTATE -5 - shortening step at time   6611.2222531056550      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2298507996836D+12   R2 =   0.1849543502211D-05
ISTATE -5 - shortening step at time   7273.7594836584376      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.3363061657728D+12   R2 =   0.2246473289700D+02
ISTATE -5 - shortening step at time   10642.600182683222      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.3363484301836D+12   R2 =   0.1864169437358D-04
ISTATE -5 - shortening step at time   10643.937664037679      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.3699085863206D+12   R2 =   0.1034635565903D-05
ISTATE -5 - shortening step at time   11705.967921539310      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.3699310381546D+12   R2 =   0.3862635638749D-05
ISTATE -5 - shortening step at time   11706.678422614965      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.3699802870764D+12   R2 =   0.1157816627559D+03
ISTATE -5 - shortening step at time   11708.236932797194      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.4069067970558D+12   R2 =   0.1954884075554D+02
ISTATE -5 - shortening step at time   12876.797375183369      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.4475689178433D+12   R2 =   0.1952240924551D-05
ISTATE -5 - shortening step at time   14163.573349470491      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.6552342432946D+12   R2 =   0.2379055386293D-06
ISTATE -5 - shortening step at time   20735.260863752770      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.7207282214195D+12   R2 =   0.2278018242460D+01
ISTATE -5 - shortening step at time   22807.855108211104      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.7207345716343D+12   R2 =   0.2563922774861D-05
ISTATE -5 - shortening step at time   22808.056064375985      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.8720640307390D+12   R2 =   0.3353640639289D-06
ISTATE -5 - shortening step at time   27596.962998069492      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1160689207256D+13   R2 =   0.4116720807359D-06
ISTATE -5 - shortening step at time   36730.671115680387      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1184080221495D+13   R2 =   0.3700473970204D+04
ISTATE -5 - shortening step at time   37470.893085285461      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1276764945468D+13   R2 =   0.1484349207984D-06
ISTATE -5 - shortening step at time   40403.953970503419      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1404431931998D+13   R2 =   0.9187909582311D-07
ISTATE -5 - shortening step at time   44444.048480947684      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1404440601902D+13   R2 =   0.1737218177251D-05
ISTATE -5 - shortening step at time   44444.322844988128      years
At current T(=R1), MXSTEP(=I1) steps<br>
<!-- -->taken on this call before reaching TOUT.<br>
<!-- -->In the above message, I1 =      10000
In the above message, R1 =   0.1469844109525D+13
ISTATE -1: Reducing time step to    348860668800361.06      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1699348452297D+13   R2 =   0.1296189198438D+01
ISTATE -5 - shortening step at time   53776.849756219926      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.1869285763716D+13   R2 =   0.2794009520411D-07
ISTATE -5 - shortening step at time   59154.612775811620      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2056206828138D+13   R2 =   0.1255629511748D-06
ISTATE -5 - shortening step at time   65069.836333466737      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2521374357026D+13   R2 =   0.1365919764344D+04
ISTATE -5 - shortening step at time   79790.327753979582      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2736797882568D+13   R2 =   0.6336836556578D-06
ISTATE -5 - shortening step at time   86607.527929365460      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.2736802428263D+13   R2 =   0.9641643849776D-06
ISTATE -5 - shortening step at time   86607.671780484976      years
At T(=R1) and step size H(=R2), the<br>
<!-- -->corrector convergence failed repeatedly<br>
<!-- -->or with ABS(H) = HMIN.<br>
<!-- -->In the above message, R1 =   0.3010476630837D+13   R2 =   0.3394451027001D+01
ISTATE -5 - shortening step at time   95268.247811304143      years</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">model_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Result&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Dissipation Time&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> out_species</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> results</span><br></span></code></pre></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">model_table</span><br></span></code></pre></div></div>
<div><table border="1" class="dataframe"><thead><tr><th></th><th>shock_velocity</th><th>density</th><th>outputFile</th><th>Result</th><th>Dissipation Time</th><th>CO</th><th>H2O</th><th>CH3OH</th></tr></thead><tbody><tr><th>0</th><td>10.0</td><td>10000.0</td><td>../grid_folder/shocks/10.0_10000.0.csv</td><td>0.0</td><td>1171.898734</td><td>5.973692e-05</td><td>2.390674e-05</td><td>2.573049e-11</td></tr><tr><th>1</th><td>30.0</td><td>10000.0</td><td>../grid_folder/shocks/30.0_10000.0.csv</td><td>0.0</td><td>1171.898734</td><td>2.502361e-05</td><td>2.420695e-05</td><td>9.976796e-07</td></tr><tr><th>2</th><td>50.0</td><td>10000.0</td><td>../grid_folder/shocks/50.0_10000.0.csv</td><td>0.0</td><td>1171.898734</td><td>1.339461e-05</td><td>1.069392e-05</td><td>5.981371e-07</td></tr><tr><th>3</th><td>10.0</td><td>100000.0</td><td>../grid_folder/shocks/10.0_100000.0.csv</td><td>0.0</td><td>117.189873</td><td>1.233292e-07</td><td>1.140102e-09</td><td>1.453093e-11</td></tr><tr><th>4</th><td>30.0</td><td>100000.0</td><td>../grid_folder/shocks/30.0_100000.0.csv</td><td>0.0</td><td>117.189873</td><td>1.146282e-22</td><td>1.279723e-20</td><td>1.181856e-20</td></tr><tr><th>5</th><td>50.0</td><td>100000.0</td><td>../grid_folder/shocks/50.0_100000.0.csv</td><td>0.0</td><td>117.189873</td><td>1.252981e-23</td><td>1.076729e-21</td><td>1.259819e-21</td></tr><tr><th>6</th><td>10.0</td><td>1000000.0</td><td>../grid_folder/shocks/10.0_1000000.0.csv</td><td>0.0</td><td>11.718987</td><td>3.743088e-27</td><td>6.926607e-23</td><td>1.151194e-22</td></tr><tr><th>7</th><td>30.0</td><td>1000000.0</td><td>../grid_folder/shocks/30.0_1000000.0.csv</td><td>0.0</td><td>11.718987</td><td>2.389471e-29</td><td>1.420828e-23</td><td>1.372137e-23</td></tr><tr><th>8</th><td>50.0</td><td>1000000.0</td><td>../grid_folder/shocks/50.0_1000000.0.csv</td><td>0.0</td><td>11.718987</td><td>4.851176e-29</td><td>2.837123e-23</td><td>3.136032e-23</td></tr></tbody></table></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">â€‹</a></h2>
<p>There are many ways to run grids of models and users will naturally develop their own methods. This notebook is just a simple example of how to run UCLCHEM for many parameter combinations whilst producing a useful output (the model_table) to keep track of all the combinations that were run. In a real script, we&#x27;d save the model file to csv at the end.</p>
<p>For much larger grids, it&#x27;s recommended that you find a way to make your script robust to failure. Over a huge range of parameters, it is quite likely UCLCHEM will hit integration trouble for at least a few parameter combinations. Very occasionally, UCLCHEM will get caught in a loop where it fails to integrate and cannot adjust its strategy to manage it. This isn&#x27;t a problem for small grids as the model can be stopped and the tolerances adjusted. However, for very large grids, you may end up locking all threads as they each get stuck on a different model. The best solution we&#x27;ve found for this case is to add a check so that models in your dataframe are skipped if their file already exists, this allows you to stop and restart the grid script as needed.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/2b_modelling_objects_in_memory"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Advanced Physical Modelling in Memory</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/chemical_analysis"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Chemical Analysis</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#a-simple-grid" class="table-of-contents__link toc-highlight">A Simple Grid</a><ul><li><a href="#define-parameter-space" class="table-of-contents__link toc-highlight">Define Parameter Space</a></li><li><a href="#set-up-the-model" class="table-of-contents__link toc-highlight">Set up the model</a></li><li><a href="#run-grid" class="table-of-contents__link toc-highlight">Run Grid</a></li></ul></li><li><a href="#checking-your-grid" class="table-of-contents__link toc-highlight">Checking Your Grid</a></li><li><a href="#complex-grid" class="table-of-contents__link toc-highlight">Complex Grid</a></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/uclchem-logo.jpg" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/uclchem-logo.jpg" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></div><div class="footer__copyright">Copyright Â© 2023 Leiden University</div></div></div></footer></div>
</body>
</html>